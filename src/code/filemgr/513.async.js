"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[513],{68996:function(x,b,e){e.d(b,{r:function(){return a}});var R=e(97857),r=e.n(R),f=e(86074);function a(_){var P=_.disabled,W=_.children,A=_.message;return(0,f.jsxs)("div",{style:r()({position:"relative"},P?{cursor:"not-allowed",display:"block",maxHeight:"100vh",overflow:"hidden"}:{}),children:[P&&(0,f.jsx)("div",{style:{position:"absolute",fontWeight:"bold",zIndex:1,transform:"translate(0, -50%)",top:"50%",left:0,right:0,textAlign:"center"},children:A||"\u60A8\u672A\u6302\u8F7D NAS\uFF0C\u65E0\u6CD5\u5F00\u542F\u6587\u4EF6\u7BA1\u7406\u529F\u80FD\u3002"}),(0,f.jsx)("div",{style:P?{pointerEvents:"none",filter:"opacity(0.5) grayscale(1)"}:{},children:W})]})}},68797:function(x,b,e){e.d(b,{Q:function(){return I}});var R=e(97857),r=e.n(R),f=e(15009),a=e.n(f),_=e(99289),P=e.n(_),W=e(5574),A=e.n(W),F=e(36147),z=e(71577),$=e(62435),l=e(86074);function I(k){var O=k.modalProps,B=k.buttonProps,N=k.children,w=k.beforeRequest,D=k.afterRequest,h=k.request,S=k.setVisibleCallback,G=$.useState(!1),Z=A()(G,2),Q=Z[0],t=Z[1];return $.useEffect(function(){S&&S(t)},[t]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(F.Z,r()(r()({open:Q,onCancel:function(){return t(!1)},maskClosable:!0,destroyOnClose:!0,onOk:P()(a()().mark(function u(){var c;return a()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(h){n.next=2;break}return n.abrupt("return");case 2:return w&&w(),n.prev=3,n.next=6,h();case 6:c=n.sent,c.success?(D&&D(!0),t(!1)):D&&D(!1,"".concat(c.errMsg)),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(3),D&&D(!1,"".concat(n.t0));case 13:case"end":return n.stop()}},u,null,[[3,10]])})),okButtonProps:h?{}:{style:{display:"none"}}},O),{},{children:Q&&N})),(0,l.jsx)(z.ZP,r()({onClick:function(){return t(!0)}},B))]})}},25864:function(x,b,e){e.d(b,{E:function(){return N}});var R=e(97857),r=e.n(R),f=e(92380),a=e(85504),_=e(53371),P=e(90105),W=e(18629),A=e(42075),F=e(82424),z=e(83062),$=e(69814),l=e(71577),I=e(29209),k=e(62435),O=e(86074);function B(w){var D=w.task,h=w.onRemove,S=D.getFileName(),G=Math.round(D.getProgress()*1e4)/100,Z=D.getCurrent(),Q=D.getTotal(),t=D.getError(),u=D.isFinished();return(0,O.jsxs)(A.Z,{direction:"vertical",style:{width:"100%"},size:0,children:[(0,O.jsxs)(A.Z,{style:{width:"100%",justifyContent:"space-between"},children:[(0,O.jsx)(F.Z.Text,{strong:!0,children:(0,O.jsx)(z.Z,{title:S,children:(0,_.Us)(S)})}),(0,O.jsxs)("span",{children:[(0,f.t)(Z)," / ",(0,f.t)(Q)]})]}),(0,O.jsx)($.Z,{percent:G,status:t?"exception":u?"success":void 0}),!!t&&(0,O.jsx)("span",{style:{color:"red"},children:t}),(0,O.jsxs)(A.Z,{style:{justifyContent:"flex-end",width:"100%"},children:[(0,O.jsx)(l.ZP,{size:"small",onClick:function(){h()},children:"\u5220\u9664\u8BB0\u5F55"}),(0,O.jsx)(l.ZP,{size:"small",danger:!0,onClick:function(){D.stop()},disabled:!!t||!!u,children:"\u53D6\u6D88\u4E0A\u4F20"}),(0,O.jsx)(l.ZP,{size:"small",disabled:!t,onClick:function(){D.run()},children:"\u91CD\u65B0\u4E0A\u4F20"})]})]})}function N(){var w=k.useContext(a._),D=w.tasks,h=w.setCtx,S=P.Z();return W.Z(S,200),(0,O.jsx)(I.Z,{header:(0,O.jsx)("span",{style:{color:"#ed7075"},children:"\u4E0A\u4F20\u8FC7\u7A0B\u4E2D\u8BF7\u52FF\u5237\u65B0\u9875\u9762"}),dataSource:D,renderItem:function(Z){return(0,O.jsx)(I.Z.Item,{children:(0,O.jsx)(B,{task:Z,onRemove:function(){h(function(t){var u;return r()(r()({},t),{},{tasks:t==null||(u=t.tasks)===null||u===void 0?void 0:u.filter(function(c){return c.key!==Z.key})})})}})})},locale:{emptyText:"\u6682\u65E0\u4E0A\u4F20\u4EFB\u52A1"}})}},70507:function(x,b,e){var R=e(50942),r=e(6154);r.Z.interceptors.response.use(function(f){return f},function(f){return f.response&&(f.response.status===401&&R.m8.push("/login"),f.response.status!==200)?f.response:Promise.reject(f)}),b.Z=r.Z},55617:function(x,b,e){e.d(b,{Q4:function(){return z},Zl:function(){return W},_2:function(){return A},fX:function(){return $}});var R=e(15009),r=e.n(R),f=e(99289),a=e.n(f),_=e(62435),P=e(70507),W;(function(l){l.PAGE_INFO="page_info",l.PAGE_SD="page_sd",l.PAGE_FILEMGR="page_filemgr",l.PAGE_MODEL="page_model",l.PAGE_TERMINAL="page_terminal",l.PAGE_LORA="page_lora",l.PAGE_DOCUMENT="page_document",l.PAGE_UPLOAD="page_upload",l.CHANGE_SIDEMENU="change_sidemenu",l.TRY_MODEL="try_model",l.DOWNLOAD_MODEL="download_model",l.UPLOAD_ERROR="upload_error"})(W||(W={}));function A(l,I){return F.apply(this,arguments)}function F(){return F=a()(r()().mark(function l(I,k){return r()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:if(!window.ENABLE_COLLECT){B.next=3;break}return B.next=3,P.Z.post("/api/collect/tracker",[{key:I,payload:k,ts:Date.now(),source:"filemgr"}]);case 3:case"end":return B.stop()}},l)})),F.apply(this,arguments)}function z(l,I){_.useEffect(function(){A(l,I)},[])}function $(l){var I=l.key,k=l.payload;z(I,k)}},61039:function(x,b,e){e.d(b,{$R:function(){return w},C7:function(){return P},L6:function(){return z},MB:function(){return Q},RN:function(){return G},Ri:function(){return h},Yd:function(){return A},ap:function(){return B},cy:function(){return k},jW:function(){return l}});var R=e(15009),r=e.n(R),f=e(99289),a=e.n(f),_=e(70507);function P(t,u){return W.apply(this,arguments)}function W(){return W=a()(r()().mark(function t(u,c){var M;return r()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,_.Z.get("/api/file/list",{params:{path:u,dir_size:c}});case 2:return M=i.sent,i.abrupt("return",M.data);case 4:case"end":return i.stop()}},t)})),W.apply(this,arguments)}function A(t){return F.apply(this,arguments)}function F(){return F=a()(r()().mark(function t(u){var c;return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,_.Z.delete("/api/file?path=".concat(u));case 2:return c=n.sent,n.abrupt("return",c.data);case 4:case"end":return n.stop()}},t)})),F.apply(this,arguments)}function z(t){return $.apply(this,arguments)}function $(){return $=a()(r()().mark(function t(u){var c;return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,_.Z.put("/api/folder",null,{params:{path:u}});case 2:return c=n.sent,n.abrupt("return",c.data);case 4:case"end":return n.stop()}},t)})),$.apply(this,arguments)}function l(t,u){return I.apply(this,arguments)}function I(){return I=a()(r()().mark(function t(u,c){var M;return r()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,_.Z.post("/api/file/move",null,{params:{src:u,dst:c}});case 2:return M=i.sent,i.abrupt("return",M.data);case 4:case"end":return i.stop()}},t)})),I.apply(this,arguments)}function k(t,u){return O.apply(this,arguments)}function O(){return O=a()(r()().mark(function t(u,c){var M;return r()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,_.Z.post("/api/file/copy",null,{params:{src:u,dst:c}});case 2:return M=i.sent,i.abrupt("return",M.data);case 4:case"end":return i.stop()}},t)})),O.apply(this,arguments)}function B(t){return N.apply(this,arguments)}function N(){return N=a()(r()().mark(function t(u){var c;return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,_.Z.get("/api/file/size",{params:{path:u}});case 2:return c=n.sent,n.abrupt("return",c.data);case 4:case"end":return n.stop()}},t)})),N.apply(this,arguments)}function w(t,u){return D.apply(this,arguments)}function D(){return D=a()(r()().mark(function t(u,c){var M;return r()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,_.Z.post("/api/file/zip",{files:u,dst:c});case 2:return M=i.sent,i.abrupt("return",M.data);case 4:case"end":return i.stop()}},t)})),D.apply(this,arguments)}function h(t,u){return S.apply(this,arguments)}function S(){return S=a()(r()().mark(function t(u,c){var M;return r()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,_.Z.post("/api/file/unzip",null,{params:{src:u,dst:c}});case 2:return M=i.sent,i.abrupt("return",M.data);case 4:case"end":return i.stop()}},t)})),S.apply(this,arguments)}function G(t){return Z.apply(this,arguments)}function Z(){return Z=a()(r()().mark(function t(u){var c;return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,_.Z.get("/api/file/preview",{params:{path:u}});case 2:return c=n.sent,n.abrupt("return",c.data);case 4:case"end":return n.stop()}},t)})),Z.apply(this,arguments)}function Q(t){return"/api/file?path=".concat(encodeURIComponent(t))}},43331:function(x,b,e){e.d(b,{Vz:function(){return se},qU:function(){return ae},tw:function(){return te}});var R=e(15009),r=e.n(R),f=e(99289),a=e.n(f),_=e(25098),P=e.n(_),W=e(28785),A=e.n(W),F=e(48374),z=e.n(F),$=e(31996),l=e.n($),I=e(26037),k=e.n(I),O=e(12444),B=e.n(O),N=e(72004),w=e.n(N),D=e(9783),h=e.n(D),S=function(){function T(m){B()(this,T),h()(this,"maxRunning",void 0),h()(this,"running",void 0),this.maxRunning=m,this.running=0}return w()(T,[{key:"getToken",value:function(){var m=a()(r()().mark(function g(){var v=this;return r()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!(this.running>=this.maxRunning)){s.next=3;break}return s.next=3,new Promise(function(E){var L=setInterval(function(){v.running<v.maxRunning&&(clearInterval(L),E(void 0))},100)});case 3:this.running++;case 4:case"end":return s.stop()}},g,this)}));function d(){return m.apply(this,arguments)}return d}()},{key:"releaseToken",value:function(){this.running--}}]),T}(),G=e(55617),Z=e(61039),Q=e(70507);function t(T,m,d,g){return u.apply(this,arguments)}function u(){return u=a()(r()().mark(function T(m,d,g,v){var o;return r()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,Q.Z.post("/api/upload/chunk?filename=".concat(encodeURIComponent(m),"&start=").concat(encodeURIComponent(d)),g,{timeout:v});case 2:return o=E.sent,E.abrupt("return",o.data);case 4:case"end":return E.stop()}},T)})),u.apply(this,arguments)}function c(T,m,d,g,v){return M.apply(this,arguments)}function M(){return M=a()(r()().mark(function T(m,d,g,v,o){return r()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,new Promise(function(L,j){var y=new WebSocket("".concat(location.protocol.replace("http","ws"),"//").concat(location.hostname,":").concat(location.port,"/api/upload/url?filename=").concat(encodeURIComponent(m),"&url=").concat(encodeURIComponent(d)));o&&o(y),y.onerror=j,y.onopen=function(){y.send("client send hi")};var C=!1,K="";y.onmessage=function(ee){try{var U=JSON.parse(ee.data),re=U.current,Y=U.total,H=U.success,J=U.errMsg;H===!0?C=!0:H===!1?(C=!1,K=J):g(re,Y)}catch(q){console.error(q),console.log(ee)}},y.onclose=function(){L(void 0),y.close(),console.log("ws closed",K),v(C,K)}});case 2:return E.abrupt("return",{success:!0});case 3:case"end":return E.stop()}},T)})),M.apply(this,arguments)}var n=new S(32),i=function(){function T(){B()(this,T),h()(this,"key",""),h()(this,"type","unknown"),h()(this,"target",""),h()(this,"current",0),h()(this,"total",0),h()(this,"finished",!1),h()(this,"error",""),h()(this,"cancel",!1),this.key=Math.random().toString(36).substr(2,8)}return w()(T,[{key:"getKey",value:function(){return this.key}},{key:"getCurrent",value:function(){return this.current}},{key:"getTotal",value:function(){return this.total}},{key:"getProgress",value:function(){return this.total===0?0:this.current/this.total}},{key:"getFileName",value:function(){return this.target}},{key:"isFinished",value:function(){return this.finished}},{key:"getError",value:function(){return this.error}},{key:"run",value:function(){this.cancel=!1,this.error=""}},{key:"stop",value:function(){this.cancel=!0,this.error="\u7528\u6237\u53D6\u6D88"}}]),T}(),se=function(T){l()(d,T);var m=k()(d);function d(g,v){var o;return B()(this,d),o=m.call(this),h()(P()(o),"type","chunk"),h()(P()(o),"chunkSize",1024*1024),h()(P()(o),"file",void 0),o.file=g,o.target=v,o}return w()(d,[{key:"uploadWithRetry",value:function(){var g=a()(r()().mark(function o(s,E,L){var j,y,C;return r()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:j=5,y="";case 2:if(!(j>0)){p.next=23;break}return p.prev=3,p.next=6,t(s,E,L,this.chunkSize/20480*1e3);case 6:if(C=p.sent,C.success){p.next=13;break}return j--,y=C.errMsg,p.abrupt("continue",2);case 13:return p.abrupt("return",{success:!0});case 14:p.next=21;break;case 16:return p.prev=16,p.t0=p.catch(3),j--,y=p.t0.toString(),p.abrupt("continue",2);case 21:p.next=2;break;case 23:return p.abrupt("return",{success:!1,errMsg:"retry times exceed, still got error ".concat(y)});case 24:case"end":return p.stop()}},o,this,[[3,16]])}));function v(o,s,E){return g.apply(this,arguments)}return v}()},{key:"run",value:function(){var g=a()(r()().mark(function o(){var s=this,E,L,j,y,C,K,p;return r()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return U.next=2,A()(z()(d.prototype),"run",this).call(this);case 2:E=this.file,L=this.target,this.total=E.size,j=Math.ceil(this.file.size/this.chunkSize),y=[],C=r()().mark(function re(){var Y,H,J,q;return r()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:if(!s.cancel){V.next=2;break}return V.abrupt("return","break");case 2:return Y=K*s.chunkSize,H=Math.min(Y+s.chunkSize,E.size),J=E.slice(Y,H),q=H-Y,V.next=8,n.getToken();case 8:if(y.push(a()(r()().mark(function ue(){var ne;return r()().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return X.next=2,s.uploadWithRetry(L,Y,J);case 2:ne=X.sent,s.current+=q,n.releaseToken(),!ne.success&&!s.cancel&&(s.error=ne.errMsg);case 6:case"end":return X.stop()}},ue)}))()),!(s.error||s.cancel)){V.next=11;break}return V.abrupt("return","break");case 11:case"end":return V.stop()}},re)}),K=0;case 9:if(!(K<j)){U.next=17;break}return U.delegateYield(C(),"t0",11);case 11:if(p=U.t0,p!=="break"){U.next=14;break}return U.abrupt("break",17);case 14:K++,U.next=9;break;case 17:return U.next=19,Promise.all(y);case 19:if(this.error&&(0,G._2)(G.Zl.UPLOAD_ERROR,{err:this.error,filename:this.getFileName(),local:this.file.name,total:this.getTotal(),current:this.getCurrent(),process:this.getProgress()}),!this.cancel){U.next=22;break}return U.abrupt("return");case 22:this.error||(this.finished=!0);case 23:case"end":return U.stop()}},o,this)}));function v(){return g.apply(this,arguments)}return v}()},{key:"stop",value:function(){A()(z()(d.prototype),"stop",this).call(this)}}]),d}(i),te=function(T){l()(d,T);var m=k()(d);function d(g,v){var o;return B()(this,d),o=m.call(this),h()(P()(o),"type","url"),h()(P()(o),"url",void 0),h()(P()(o),"ws",void 0),o.url=g,o.target=v,o}return w()(d,[{key:"run",value:function(){var g=a()(r()().mark(function o(){var s=this;return r()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,A()(z()(d.prototype),"run",this).call(this);case 2:return L.next=4,c(this.target,this.url,function(j,y){s.current=j,s.total=y},function(j,y){y&&(0,G._2)(G.Zl.UPLOAD_ERROR,{err:s.error,filename:s.getFileName(),url:s.url,total:s.getTotal(),current:s.getCurrent(),process:s.getProgress()}),s.finished=j,!s.cancel&&(s.error=y||"")},function(j){return s.ws=j});case 4:case"end":return L.stop()}},o,this)}));function v(){return g.apply(this,arguments)}return v}()},{key:"stop",value:function(){var v;A()(z()(d.prototype),"stop",this).call(this),this===null||this===void 0||(v=this.ws)===null||v===void 0||v.close()}}]),d}(i),ae=function(T){l()(d,T);var m=k()(d);function d(){var g;B()(this,d);for(var v=arguments.length,o=new Array(v),s=0;s<v;s++)o[s]=arguments[s];return g=m.call.apply(m,[this].concat(o)),h()(P()(g),"type","url_unzip"),g}return w()(d,[{key:"run",value:function(){var g=a()(r()().mark(function o(){var s=this,E,L,j;return r()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return this.cancel=!1,this.error="",C.next=4,c(this.target,this.url,function(K,p){s.current=K,s.total=p},function(K,p){s.finished=K,!s.cancel&&(s.error=p||"")},function(K){return s.ws=K});case 4:if(E=C.sent,L=E.success,!(L&&!this.cancel)){C.next=17;break}return C.next=9,(0,Z.Ri)(this.target,this.target.slice(0,-4));case 9:if(j=C.sent,j.success){C.next=14;break}this.error=j.errMsg,C.next=17;break;case 14:return C.next=16,(0,Z.Yd)(this.target);case 16:this.finished=!0;case 17:case"end":return C.stop()}},o,this)}));function v(){return g.apply(this,arguments)}return v}()}]),d}(te)},92380:function(x,b,e){e.d(b,{t:function(){return R}});function R(r){for(var f=["B","KB","MB","GB","TB"],a=0;r>1024;)r/=1024,a++;return"".concat(r.toFixed(2)," ").concat(f[a])}},85504:function(x,b,e){e.d(b,{_:function(){return f},i:function(){return r}});var R=e(62435),r={info:void 0,tasks:[],setCtx:function(){}},f=R.createContext(r)},53371:function(x,b,e){e.d(b,{Dy:function(){return f},Us:function(){return r},XP:function(){return R}});function R(a){var _=a.lastIndexOf("/");return _===-1?"/":a.substring(0,_)}function r(a){var _=a.lastIndexOf("/");return _===-1?a:a.substring(_+1)}function f(){for(var a=arguments.length,_=new Array(a),P=0;P<a;P++)_[P]=arguments[P];return _.join("/").replace(/\/+/g,"/")}}}]);
